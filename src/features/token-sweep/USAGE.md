# Token Sweep 使用指南

批量归集多个钱包的代币到指定地址。

## 快速开始

访问: `http://localhost:5174/apps/token-sweep`

## 完整流程（5步）

### Step 1: Connect Wallet 🔗

**操作**:

1. 点击 "Connect Wallet" 按钮
2. 选择钱包（MetaMask等）
3. 授权连接

**检查**:

- ✅ 钱包地址显示
- ✅ 网络名称显示
- ✅ 余额显示

---

### Step 2: Check Dependencies 🔍

**自动检查**:

- CREATE2 Proxy 部署状态

**如果未部署**:

1. 点击 "Deploy Contract" 按钮
2. 按照步骤：
   - Fund deployer address
   - Deploy contract
3. 等待确认

**检查**:

- ✅ 所有依赖项显示绿色 ✓

---

### Step 3: Select Tokens 🪙

**操作**:

1. 查看当前网络的可用代币
2. 点击代币卡片进行多选
3. （可选）添加自定义代币
   - 点击 "➕ Add Custom Token"
   - 输入代币地址、符号、名称、小数位
4. 点击 "Continue" 进入下一步

**提示**:

- 绿色勾选标记 = 已选中
- 可以使用 "Select All" / "Deselect All"
- 自定义代币会保存到 localStorage

**检查**:

- ✅ 至少选择1个代币
- ✅ Sidebar显示选中数量

---

### Step 4: Import Wallets 👛

#### 方式1: 助记词导入

**操作**:

1. 选择 "Mnemonic Phrase" 标签
2. 输入12或24个单词的助记词
3. 选择派生类型：
   - **Sequential**: 顺序派生（推荐）
     - 设置范围：Start Index → End Index
     - 默认：0-99（100个地址）
     - 最大：1000个地址/次
   - **Date-based**: 日期派生（待实现）
4. 点击 "Generate Addresses"

#### 方式2: 私钥批量导入

**操作**:

1. 选择 "Private Keys" 标签
2. 每行粘贴一个私钥
3. 格式：`0x...` (64位十六进制)
4. 点击 "Import Private Keys"

#### 余额扫描（可选）

**操作**:

1. 导入钱包后，点击 "🔍 Scan Balances"
2. 等待扫描完成（显示进度）
3. 查看有余额的钱包数量

**提示**:

- 🔵 蓝色徽章 = 有余额的钱包数
- 扫描需要RPC调用（当前版本为占位）

**检查**:

- ✅ 至少导入1个钱包
- ✅ Sidebar显示钱包数量
- ✅（可选）显示余额统计

---

### Step 5: Confirm Sweep ✅

**查看配置**:

1. **Target Address**: 输入接收地址（0x...）
2. **Selected Tokens**: 查看选中的代币列表
3. **Balance Filter**:
   - 如果扫描了余额，可选择：
   - ☑️ "Only sweep wallets with balance"
4. **Batch Processing**: 查看批次信息
   - 每批最多100个钱包
5. **Estimated Costs**: 查看费用预估

**执行**:

1. 确认所有信息无误
2. 点击 "Execute Sweep 🚀"
3. 查看执行预览
4. （当前版本显示预览信息）

**检查**:

- ✅ 目标地址格式正确
- ✅ 至少1个代币
- ✅ 至少1个钱包
- ✅ 批次数量合理

---

## 功能亮点

### 🎯 智能过滤

- 扫描余额后，可以只归集有余额的钱包
- 避免处理空钱包，节省gas

### 📦 批次处理

- 自动分批（100个钱包/批）
- 清晰显示每批钱包数
- 防止交易失败

### 💾 数据持久化

- 自定义代币保存到 localStorage
- 下次使用自动加载

### 🔒 安全提示

- 助记词仅本地处理
- 生成地址后自动清空
- 不上传任何私钥

---

## 常见问题

### Q: 助记词导入后看不到钱包？

**A**: 检查：

- 助记词是否正确（12或24个单词）
- 单词之间用空格分隔
- 没有多余的空格或换行

### Q: 如何知道哪些钱包有余额？

**A**:

1. 在 Step 4 点击 "🔍 Scan Balances"
2. 等待扫描完成
3. Sidebar会显示 "With Balance: X"

### Q: 批次数量太多怎么办？

**A**:

- 使用余额过滤，只归集有余额的钱包
- 或分多次导入和执行

### Q: 自定义代币如何删除？

**A**:

- 在 Step 3，找到自定义代币
- 点击代币卡片上的 🗑️ 图标

### Q: 可以归集多个网络的代币吗？

**A**:

- 不能，每次只能归集当前连接网络的代币
- 需要切换网络后重新操作

---

## 注意事项

⚠️ **重要提示**:

1. 请在测试网（如Sepolia）先测试
2. 确保目标地址正确（无法撤销）
3. 预留足够的gas费用
4. 大额转账前小额测试

⚠️ **当前限制**:

1. 余额扫描功能UI已完成，Web3集成待实现
2. 实际Sweep执行逻辑待实现
3. 仅显示预览信息

---

## 下一步计划

- [ ] 实现Web3余额扫描
- [ ] 实现批量转账执行
- [ ] 添加交易进度监控
- [ ] 支持EIP-7702委托签名

---

## 技术支持

遇到问题？

- 检查浏览器控制台错误
- 确认钱包已连接
- 确认网络正确
